<!DOCTYPE html>
<html lang="kr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ëŒ€í–‰ ê²¬ì  ê³„ì‚°ê¸°</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
      $(function () {
        $("#hiddenOutput").hide();
        errorHide();
        $("input:radio[name=kbn]").on("change", function () {
          errorHide();
          if ($(this).val() == 3) {
            $("#charge").attr("disabled", true);
            $("#charge").val(0);
          } else {
            $("#charge").attr("disabled", false);
            $("#charge").val("");
          }
        });

        $("#calBtn").on("click", function () {
          errorHide();
          let errors = [];

          $("input").each(function () {
            if ($(this).attr("type") !== "radio") {
              if ($(this).val() == "") {
                errors.push($(this).attr("id"));
              }
            }
          });

          if ($("input[name=kbn]:checked").val() == undefined) {
            errors.push("kbn");
          }

          if (errors.length != 0) {
            errors.forEach(function (id) {
              $(`#error-${id}`).show();
              $(`#${id}`).addClass("error-input");
            });
          } else {
            $("#output").show();
            createText(
              $("input[name=kbn]:checked").val(),
              $("#money").val(),
              $("#charge").val(),
              $("#currency").val()
            );
          }
        });

        $("#copyBtn").on("click", function () {
          $("#calBtn").click();
          if ($("#output").text() != "") {
            $("#hiddenOutput").show();

            $("#hiddenOutput").text($("#output").text());
            $("#hiddenOutput").select();
            console.log($("#hiddenOutput").text());
            document.execCommand("copy");
            $("#hiddenOutput").hide();
          }
        });
      });

      function errorHide() {
        $("[id ^= error-]").each(function () {
          $(this).hide();
          $("#output").hide();

          let id = $(this).attr("id").replace("error-", "");
          $(`#${id}`).removeClass("error-input");
        });
      }

      function createText(chargeLabel, money, charge, currency) {
        let moneyNum = Number.parseInt(money);
        let chargeNum = Number.parseInt(charge);
        let currencyFloat = Number.parseFloat(currency);
        let result = Math.ceil(((moneyNum + chargeNum) * (currencyFloat + 15)) / 100) + 3000;
        $("#output").html(
          `
          ì´ ì…ê¸ˆ ê¸ˆì•¡ì€ ${result.toLocaleString()} ì› ì…ë‹ˆë‹¤.</br>
          í† ìŠ¤ ì‚¬ìš©í•˜ì‹œë©´ í† ìŠ¤ì…ê¸ˆê³„ì¢Œ ì•ˆë‚´ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤!</br>
          </br>
          ğŸ’¡ê²¬ì </br>
          (ì˜ë¢°ê¸ˆì•¡ ${moneyNum.toLocaleString()}ì—”${
            chargeLabel == 1
              ? ` + í¸ì˜ì ìˆ˜ìˆ˜ë£Œ ${chargeNum.toLocaleString()}ì—”`
              : chargeLabel == 2
              ? ` + ì†¡ê¸ˆìˆ˜ìˆ˜ë£Œ ${chargeNum.toLocaleString()}ì—”`
              : ""
          }) * í™˜ìœ¨ + ëŒ€í–‰ìˆ˜ìˆ˜ë£Œ 3,000ì›</br>
          </br>
          ğŸ’¡í™˜ìœ¨</br>
          ${currencyFloat.toLocaleString()} + 15ì› = ${(currencyFloat + 15).toLocaleString()}ì›
          `
        );
      }
    </script>
  </head>
  <body>
    <div class="headArea">
      <label>ëŒ€í–‰ ê²¬ì  ê³„ì‚°ê¸°</label>
    </div>
    <div class="bodyArea">
      <div>
        <label>ì˜ë¢°êµ¬ë¶„</label>
        <form class="gridDiv" value="0">
          <div>
            <input type="radio" name="kbn" id="radio1" value="1" /><label
              for="radio1"
              >í¸ì˜ì </label
            >
          </div>
          <div>
            <input type="radio" name="kbn" id="radio2" value="2" /><label
              for="radio2"
              >ì†¡ê¸ˆ</label
            >
          </div>
          <div>
            <input type="radio" name="kbn" id="radio3" value="3" /><label
              for="radio3"
              >ì¼ë°˜</label
            >
          </div>
        </form>
        <label class="error" id="error-kbn">í•„ìˆ˜ ì„ íƒ ê°’ì…ë‹ˆë‹¤.</label>
      </div>
      <div>
        <label>ì˜ë¢°ê¸ˆì•¡</label>
        <input type="number" id="money" placeholder="ì˜ˆ: 15100" />
        <label class="error" id="error-money">í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.</label>
      </div>
      <div>
        <label>ì¶”ê°€ìˆ˜ìˆ˜ë£Œ</label>
        <input type="number" id="charge" placeholder="ì˜ˆ: 220" />
        <label class="error" id="error-charge">í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.</label>
      </div>
      <div>
        <label>í˜„ì¬ í™˜ìœ¨</label>
        <input type="number" step="0.01" id="currency" placeholder="ì˜ˆ: 914.12" />
        <label class="error" id="error-currency">í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.</label>
      </div>
    </div>
    <div class="buttonArea">
      <button id="calBtn">ê²¬ì  ê³„ì‚°</button>
      <button id="copyBtn">ë¬¸ì¥ ë³µì‚¬</button>
    </div>
    <div class="textArea">
      <textarea id="hiddenOutput"></textarea>
      <label id="output"></label>
    </div>
  </body>
</html>
